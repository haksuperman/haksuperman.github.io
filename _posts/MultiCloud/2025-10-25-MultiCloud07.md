---
title: "[Multi Cloud] AWS-OCI VPN Turnel 이중화 (BGP)_7.AWS-OCI VPN2 구성(OCI)"       # 글 제목
date: 2025-10-25 20:30:00 +0900        # 작성 시간
categories: [CLOUD, MULTICLOUD]        # [대분류, 소분류]
tags: [aws, oci, vpn, turnel, bgp, asn, duplication]     # 태그 (반드시 소문자로 시작 권장)
---
## 7.1. CPE

### 7.1.1. AWS 측 VPN Turnel 2 IP 확인

-   Virtual Private Gateway 항목 확인
-   OCI 측에서 CPE IP에 해당
![image](https://blog.kakaocdn.net/dna/Zm2xS/dJMb9j1IVCj/AAAAAAAAAAAAAAAAAAAAACaf6Id-m4hGxQJpXzVcuxMyz0iZVDPj6Buial4gWleK/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=zlmNIQ5M4PmoEVQCVArKqQeB0IM%3D)

### 3.1.2. 설정

1. 내비게이션 메뉴 → Networking → Customer connectivity → Customer-premises equipment
![image](https://blog.kakaocdn.net/dna/5uDgA/dJMb88MFj1T/AAAAAAAAAAAAAAAAAAAAAJ435yfTORxsCA_q8A01tVA6n0WZmuVdrIKwvSkBCuyp/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=zh8%2FNe6wAG%2FBil9m%2F3TzK5HQA3I%3D)

2. Create CPE
- Name : \<적절한 이름 입력>
- IP address : \<위에서 확인한 AWS 측 VPN Turnel 1 IP 입력>
- Vendor : Other
![image](https://blog.kakaocdn.net/dna/b1UpMY/dJMb8YwvOC6/AAAAAAAAAAAAAAAAAAAAAIblihTg5UqQZCorFilzHQhoJAIfDauEkyLqA38AmYnc/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=wN5RtBaIPdjsGwpunYO0DXNHCM8%3D)

3. 생성 확인
![image](https://blog.kakaocdn.net/dna/cDsRou/dJMb8YwvODg/AAAAAAAAAAAAAAAAAAAAAPVy8kAI9cbetohQe1upRWERNjimJfb7sU_1fwT90FiY/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=BtIOyaL8XGiz0%2FApTXh5jIdfayk%3D)

## 3.2. VPN

### 3.2.1. 기본 생성

1. 내비게이션 메뉴 → Networking → Customer connectivity → Site-to-Site VPN
![image](https://blog.kakaocdn.net/dna/QzC29/dJMb9XxAoEF/AAAAAAAAAAAAAAAAAAAAAN3pO-3ktWQD6mh1JxkOUUSJdP4RClTh9HWba1vxw_bp/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=hDR1MI2S%2BdDXk5F8KjaagsnQ77Y%3D)

2. Create IPSec connection
- Name : \<적절한 이름 입력>
- Customer-premises equipment : \<위에서 생성한 CPE 선택>
- Dynamic routing gateway : \<OCI 측 네트워크에 Attach된 DRG 선택>
- Static routes to on-premises network : \<AWS 측 VPC Subnet CIDR 입력>
![image](https://blog.kakaocdn.net/dna/35bgS/dJMb9LxeWr4/AAAAAAAAAAAAAAAAAAAAACj9wwKtU4RCkLNQdOn3v-om9vBKxP6WvpIaBhcVxVVN/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=aoFcSW0aOl4XTEJIHxmRgJ0JDyA%3D)

> VPN을 BGP로 구성하는 경우, 해당 Static route to on-premises network 설정은 무시됨.  
> BGP가 실패하고 Static으로 통신해야 할 때, VPN1과 이중화를 위해 CIDR 범위를 좁게 설정 (Longest prefix match rule)
{: .prompt-info }

### 3.2.2 Turnel 2 (+Turnel 1)

1. 기본 정보
- Name : \<적절한 이름 입력>
- IKE version : IKEv2 선택
- Routing type : BGP dynamic routing 선택
![image](https://blog.kakaocdn.net/dna/bgjrkj/dJMb80ODirB/AAAAAAAAAAAAAAAAAAAAAL5G0mJcE66sp-xZXFZCdmkA3bLPnjzj5Xh35aDMIbJ5/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=VEXXql6ay5ewsruSR3MjucdsZso%3D)

2. BGP 정보
- BGP ASN : \<AWS 측 ASN 입력>
- IPv4 inside turnel interface - CPE : \<AWS 측 Virtual Private Gateway 항목 입력>
- IPv4 inside turnel interface - Oracle : \<AWS 측 Customer Gateway 항목 입력>
![image](https://blog.kakaocdn.net/dna/dMOqwP/dJMb89SlfDn/AAAAAAAAAAAAAAAAAAAAAHOugDx_HI7ts9GrVtxRE3UfYJdMmp7koKXuL8Zj56PA/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=tmi%2BGwyG8kMJs%2F0Y5GsWWKJ8ADg%3D)

3. Phase 1 → AWS 측 정보와 일치
- Encryption algorithm
- Authentication algorithm
- Diffie-Hellman group
- IKE session key lifetime
![image](https://blog.kakaocdn.net/dna/CL8K9/dJMb9QFjqVx/AAAAAAAAAAAAAAAAAAAAAGXRmTa_CcLQLarwUECLr1Aj8ynMexMrZtpabagwsK0v/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=j9MdsmQYGSlQO5qw9C8z7d7FzXU%3D)

    > AWS에서 Turnel 알고리즘 정보를 변경하지 않고 Default로 생성한 경우, 위 Configuration 파일과 같이 Phase 별 알고리즘 정보가 하나만 표기 (실제 아래 사진과 같이 모두 체크되어 이용할 수 있으나 OCI 측에서 설정되어야 하는 알고리즘 정보를 오해하기 쉬움)  
    > ![image](https://blog.kakaocdn.net/dna/dIDHM9/dJMb8XqP1fy/AAAAAAAAAAAAAAAAAAAAAEZ3FggLMy1D_aQwSa0A4hPHvx7IG3A3tpCvemOV2Jng/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=3dIW0nXqeGgTFtUe0BQAXNjUv%2B0%3D)
    > ![image](https://blog.kakaocdn.net/dna/H3sfb/dJMb9VzLPnX/AAAAAAAAAAAAAAAAAAAAAEpksDIjzrXZGZ2Y_gSniDJF-h7oJkYgVCfMHvOEnrwX/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=qAjOAqkzWSwSlOr%2FIjInPxQDBM0%3D)
    {: .prompt-info }

4. Phase 2 → AWS 측 정보와 일치
- Encryption algorithm
- IPSec session key lifetime
- Deffie-Hellman group
![image](https://blog.kakaocdn.net/dna/bvpKLA/dJMb9VzLPoi/AAAAAAAAAAAAAAAAAAAAAIqqvgmMcwYTZ3aIzd6qHLNEX-tHuS-1eTsm9wl4M6q3/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=Lbj7d4Cl9KpipA%2FKuPLaawOLJ%2Bs%3D)

    > Turnel 1은 이용하지 않지만, 동일한 방법으로 구성
    {: .prompt-info }

5. 생성 확인
![image](https://blog.kakaocdn.net/dna/dPDOLP/dJMb9VzLPoB/AAAAAAAAAAAAAAAAAAAAAC2mygBhHsY1rq5F1s7tL4rznfuhXOCJuJKMLFEc0n3F/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=Ih6OEMlKKaa7oNFtfI3wGU12ukU%3D)

### 3.2.3. Turnel configuration

1. 생성한 turnel 2 선택 → 우측 상단 Open CPE configuration helper 선택
![image](https://blog.kakaocdn.net/dna/CwDlp/dJMb9MQrwFd/AAAAAAAAAAAAAAAAAAAAAO_iMdQgo8jlYxmZlYnWFWSZj-hHhGaC-cwL2OFC6y1d/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=d1vPAJSwpy5MC4Hq%2FHvm7lHeXHU%3D)


2. 우측 하단 Create content 선택
![image](https://blog.kakaocdn.net/dna/ocZZM/dJMb9MQrwF1/AAAAAAAAAAAAAAAAAAAAAO3BFdLPMZjMRrQDerRT5N2F7kxhh7LTNQSop4vF8dFA/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=hUZUEWhP%2FVq2HJiZnVIf7bFu22o%3D)

3. Download configuration 클릭
![image](https://blog.kakaocdn.net/dna/1GyBF/dJMb9L44BL0/AAAAAAAAAAAAAAAAAAAAANfYa05V8BbqPulqH5rm5ylhVXztvDkyFc25UmvRJicX/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=bezAZ3dHTjUyKjzBAulJ%2Bqs7j7Y%3D)

4. Turnel IP 및 PSK 확인
![image](https://blog.kakaocdn.net/dna/rmIqN/dJMb9MQrwH3/AAAAAAAAAAAAAAAAAAAAAJf7GFOMHbc7oqOZ0JhBC9m2dt9dbmCqrSSilRsh0t0e/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=SOib3hICLEff331rBHprctY2OHA%3D)