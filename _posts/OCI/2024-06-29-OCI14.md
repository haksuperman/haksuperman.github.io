---
title: "[OCI] OCICLI를 활용한 자원 정리 (with. OCI Cloud Shell)"       # 글 제목
date: 2024-06-29 00:23:00 +0900 # 작성 시간
categories: [CLOUD, OCI]        # [대분류, 소분류]
tags: [oci, cloud, oraclecloud, oracle cloud infrastructure, cloudshell, ocicli]     # 태그 (반드시 소문자로 시작 권장)
---
초기에 생성했던 VCN을 제외한 나머지 모든 자원을 삭제할 것이다.

직접 GUI 관리콘솔에서 삭제할 수도 있지만, 명령줄 인터페이스(CLI)를 통해 간편하게 지울 것이다.

## 1\. OCI CLI

OCI CLI를 사용하면 쉘 스크립트, crontab 등과 함께 활용해서 OCI 자원을 자동화하거나, 정기적인 작업을 쉽게 실행할 수 있다.<br>
OCI CLI 뿐만 아니라 프로그래밍 언어를 사용해서도 오라클 클라우드 자원을 제어할 수 있다.<br>
OCI CLI를 사용하는 방법은 두 가지가 있다.
-   운영체제 환경에 OCI CLI를 설치하여 사용하는 방법
-   OCI Cloud Shell을 활용하는 방법

## 2\. OCI Cloud Shell

OCI Cloud Shell을 사용하면 OCI CLI를 설치 및 설정하고, 별도 인증 과정을 거치는 과정 없이도 오라클 클라우드 자원을 쉽게 제어할 수 있다.<br>
OCI Cloud Shell은 OCI 웹 콘솔에서 접근이 가능한 웹 브라우저 기반 터미널 환경으로 Ansible, Terraform과 같은 다양한 개발자 도구가 미리 설치되어 있다.<br>
이를 통해 별도의 환경 구성 없이도 빠르고 간편하게 클라우드 자원을 제어할 수 있다.

1. 우측 상단의 "Developer Tools" 클릭 후 Cloud Shell 클릭
![image](https://blog.kakaocdn.net/dna/dcoQYC/dJMcadgiCd3/AAAAAAAAAAAAAAAAAAAAALKhXdsPJrIdmC5ZHINdd4oeHn4ZGr3wE_33siDZfaT7/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=RKbGzQhZRpVdpHDI%2FILaZHvbJi8%3D)

2. 최초로 실행하면 튜토리얼을 수행할지 물어보는 질문에 N 입력
![image](https://blog.kakaocdn.net/dna/erx4JM/dJMcaaDUWQR/AAAAAAAAAAAAAAAAAAAAAOBIq-cAf7ZH_8amMA7cLyq99hgQPrSzhrfusag6Au7z/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=p1dJJO89nxkpU3cjMTFhynfvYIs%3D)

    > **Cloud Shell 환경 초기화**  
    > Cloud Shell 환경은 csreset -a, csreset -b 명령어를 통해 초기화가 가능하다. "csreset -a" 명령어는 사용자 홈 디렉터리와 프로파일 설정을 초기화한다. 즉, 사용자 데이터와 설정을 모두 제거하고 처음 상태로 돌린다. "csreset -b" 명령어는 브라우저 세션과 관련된 데이터를 초기화한다.
    {: .prompt-info }

3. [Identity & Security → Compartment\] 메뉴 선택
![image](https://blog.kakaocdn.net/dna/bs1zM6/btsIhz6Ejd4/AAAAAAAAAAAAAAAAAAAAAJ-aTGuQBob6whm6_F0HntxHkwtlfO6nCTvraWhkxGj1/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=7hfldpTltWx3v07xjHMuh1PBNGY%3D)

3. 컴파트먼트 OCID를 통해 인스턴스 목록 조회
![image](https://blog.kakaocdn.net/dna/UJFK0/btsIghTDDgD/AAAAAAAAAAAAAAAAAAAAAAjEAvxRd4h0kY2t6lQlKza0jsG0CQSkS1cWdbnO53gN/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=371NrRvQKrTB3Wqen2Hie%2FoxQ4s%3D)
![image](https://blog.kakaocdn.net/dna/cvIW2p/dJMcabCOTWJ/AAAAAAAAAAAAAAAAAAAAAJItdshXspfhJ6BK303lsxu6a5ngQsPsVsVK8qxA9m0m/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=9kNBN5bb3OiAVibY%2Fw4t6oPU8Mo%3D)

4. 파일로도 저장 가능
![image](https://blog.kakaocdn.net/dna/zS3H7/btsIg8hrAe1/AAAAAAAAAAAAAAAAAAAAAA8fa3Fx6gdUjl9udpvS2vL5f-_rc5LEpJQaEWiLqNj6/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=8bn9jY1RZ0rDJ2ZhdOgLp2JrbIM%3D)
![image](https://blog.kakaocdn.net/dna/bZBphc/btsIg5ZmasB/AAAAAAAAAAAAAAAAAAAAAPR3CsjqL88gAQdI2Uu75gjATGv6BYNCBOqPAaeIXlXQ/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=mKWwJgmPSRfLfbYiWJ0i1ZOH6jg%3D)

## 3\. 자원 정리

자원은 생성한 순서의 역순으로 삭제하면 된다. Autoscaling Configuration, 인스턴스 풀, Instance Configuration, 로드밸런서, 가상 머신, 이미지, 가상 머신, Bastion이다.<br>
이 중 인증서, CA와 마스터 암호화 키 그리고 Vault와 같이 즉시 삭제되지 않고 최소 일주일 이상의 삭제 대기 기간이 필요한 자원은 OCI 웹 콘솔을 통해 삭제한다.<br>
CA의 경우 인증서가 삭제된 이후에 삭제가 가능하다.

#### 1) 삭제할 자원이 속한 컴파트먼트 OCID 환경변수 지정

![image](https://blog.kakaocdn.net/dna/kZiEq/btsIibc9v5B/AAAAAAAAAAAAAAAAAAAAAN-AJ9ZaiuOhQIPES9433fVKEef8B6cRq91V0I6tIs6A/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=TtreBjOXIuxKsxp%2F11ShtZQn5fo%3D)

```bash
export COMP\_ID="<컴파트먼트 OCID>"
```

#### 2) Autoscaling Configuration 삭제

Autoscaling Configuration의 OCID를 조회해서 OCID 값을 얻은 후 이 값을 파라미터로 활용해서 Autoscaling Configuration 삭제

> \--force 옵션을 사용하면 확인 메시지 없이 삭제 작업이 가능하다!
{: .prompt-tip }

```bash
oci autoscaling configuration list -c $COMP\_ID --query 'data\[\*\].{name:"name", id:"id"}' --output table
oci autoscaling configuration delete --force --auto-scaling-configuration-id "<조회한 Autoscaling configuration OCID>"
```
![image](https://blog.kakaocdn.net/dna/btvCm7/btsIhxOx8tE/AAAAAAAAAAAAAAAAAAAAALSbsC8pV1-Hu8T2OeVpTpoHF9eojQZPFVRJ_1uZhR2C/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=TypVNXZHZ7OKsNCR0A39P1hGpdM%3D)

#### 3) 인스턴스 풀 삭제

삭제할 인스턴스 풀의 OCID를 조회해서 OCID 값을 얻은 후 이 값을 파라미터로 활용해서 인스턴스 풀을 삭제한다.

```bash
oci compute-management instance-pool list -c $COMP\_ID --query 'data\[\*\].{name:"display-name", id:"id"}' --output table
oci compute-management instance-pool terminate --force --instance-pool-id "<조회한 인스턴스 풀 1 OCID>"
oci compute-management instance-pool terminate --force --instance-pool-id "<조회한 인스턴스 풀 2 OCID>"
oci compute-management instance-pool terminate --force --instance-pool-id "<조회한 인스턴스 풀 3 OCID>"
```
![image](https://blog.kakaocdn.net/dna/kwxwX/btsIg5LMJnt/AAAAAAAAAAAAAAAAAAAAAI4pSQxWMCDri9YpbhKwigmUvClaC5W5rguNAu0P4ePV/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=V7XZAVeElkSxa0oE3%2FLxkbjfGZI%3D)


#### 4) Instance Configuration 삭제

삭제할 Instance Configuration의 OCID를 조회해서 OCID 값을 얻은 후 이 값을 파라미터로 활용해서 Instance Configuration을 삭제한다.

```bash
oci compute-management instance-configuration list -c $COMP\_ID --query 'data\[\*\].{name:"display-name", id:"id"}' --output table
oci compute-management instance-configuration delete --force --instance-configuration-id "<조회한 Instance Configuration OCID>"
```
![image](https://blog.kakaocdn.net/dna/cogshx/btsIhzS8Xkc/AAAAAAAAAAAAAAAAAAAAALAqNiOrgQ6xLz-pseQsPFn9w8VacfWWi-YBHxyVAuMq/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=xbHEroWDnLWry340eJtGSCmwK7U%3D)

#### 5) 로드밸런서 삭제
삭제할 로드밸런서의 OCID를 조회해서 OCID 값을 얻은 후 이 값을 파라미터로 활용해서 로드밸런서를 삭제한다.

```bash
oci lb load-balancer list -c $COMP\_ID --query 'data\[\*\].{name:"display-name", id:"id"}' --output table
oci lb load-balancer delete --force --load-balancer-id "<조회한 로드밸런서 OCID>"
```
![image](https://blog.kakaocdn.net/dna/lcj3e/btsIhUCFUX5/AAAAAAAAAAAAAAAAAAAAADpCO-dx5C3cRrffzw6dKe1JmmsTfI9RQ0q_bMg38C3Y/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=cuSESEWRDwjCyzjhBjacyMqiEV0%3D)

#### 6) 가상 머신 삭제
삭제할 가상 머신의 OCID를 조회해서 OCID 값을 얻은 후 이 값을 파라미터로 활용해서 가상 머신을 삭제한다.

```bash
oci compute instance list -c $COMP\_ID --query 'data\[\*\].{name:"display-name", id:"id"}' --output table
oci compute instance terminate --force --instance-id "<조회한 가상 머신 1 OCID>"
oci compute instance terminate --force --instance-id "<조회한 가상 머신 2 OCID>"
oci compute instance terminate --force --instance-id "<조회한 가상 머신 3 OCID>"
oci compute instance terminate --force --instance-id "<조회한 가상 머신 4 OCID>"
oci compute instance terminate --force --instance-id "<조회한 가상 머신 5 OCID>"
```
![image](https://blog.kakaocdn.net/dna/b1NkBk/btsIgnF9Ptv/AAAAAAAAAAAAAAAAAAAAAOauQwhdxJd0DtZcisLR91zf2XN1LUM7zfSf3tBI6TO7/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=jitY4KDLkXaLggCRhOsG4Y9FjTo%3D)

#### 7) Bastion 서비스 삭제

삭제할 Bastion 서비스의 OCID를 조ㅚ해서 OCID 값을 얻은 후 이 값을 파라미터로 활용해서 Bastion 서비스를 삭제한다.

```bash
oci bastion bastion list -c $COMP\_ID --query 'data\[\*\].{name:"name", id:"id"}' --output table --all
oci bastion bastion delete --force --bastion-id "<조회한 Bastion 서비스 OCID>"
```
![image](https://blog.kakaocdn.net/dna/uqPiA/btsIg3AssJ2/AAAAAAAAAAAAAAAAAAAAALkH_IEV5WdrVC8oPLDFwROXuOW3m3JpGnqFmDfpugPi/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1767193199&allow_ip=&allow_referer=&signature=Jkhg7kicyP8m6JXWrQUOUJcX%2FqI%3D)
